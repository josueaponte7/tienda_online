parameters:
    rabbitmq.host: '%env(RABBITMQ_HOST)%'
    rabbitmq.port: '%env(RABBITMQ_PORT)%'
    rabbitmq.user: '%env(RABBITMQ_USER)%'
    rabbitmq.password: '%env(RABBITMQ_PASSWORD)%'
    rabbitmq.vhost: '%env(RABBITMQ_VHOST)%'

services:

    _defaults:
        autowire: true
        autoconfigure: true

    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'

    App\Repository\UserRepositoryInterface:
        alias: App\Repository\UserRepository

    Redis:
        class: Redis
        factory: ['App\Factory\RedisFactory', 'create']
        arguments:
            - '%env(REDIS_URL)%'

    App\Service\RabbitMQService:
        arguments:
            $host: '%rabbitmq.host%'
            $port: '%rabbitmq.port%'
            $user: '%rabbitmq.user%'
            $password: '%rabbitmq.password%'

    Elastic\Elasticsearch\Client:
        factory: ['Elastic\Elasticsearch\ClientBuilder', 'fromConfig']
        arguments:
            - hosts: ['http://localhost:9200']
